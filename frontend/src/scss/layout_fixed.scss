/* src/scss/layout_fixed.scss
   CSS 우선순위(Specificity) 문제를 해결한 최종본
*/

// --- 변수 ---
$sidebar-width: 256px;
$header-height: 4rem;
$transition-speed: 0.2s;

html {
  font-size: 14px;
}

body {
  background-color: var(--surface-ground);
  color: var(--text-color);
  font-family: var(--font-family);
  margin: 0;
  overflow-y: auto !important;
}

/* 1. 사이드바 (app-sidebar) */
.app-sidebar.p-sidebar {
  position: fixed !important;
  top: 0;
  left: 0;
  height: 100vh !important;
  width: $sidebar-width !important;
  z-index: 999;

  /* --- 데스크탑 (Push) 스타일 (992px 이상) --- */
  @media (min-width: 992px) {
    transition: transform $transition-speed !important;

    /* ✅✅✅
     * 여기가 문제입니다!
     * "열림" 상태에서도 !important가 필요합니다.
     * (테마의 .p-sidebar-visible { transform: ... !important; } 를 덮어쓰기 위해)
     ✅✅✅
    */
    transform: translateX(0) !important;

    // CoreUI 스타일
    box-shadow: none !important;
    border-radius: 0 !important;
    border-right: 1px solid var(--surface-border);
  }

  /* --- 모바일 (Overlay) 스타일 (991px 이하) --- */
  @media (max-width: 991px) {
    border-right: none !important;
    box-shadow: var(--overlay-shadow) !important;
  }

  /* --- 공통 내부 스타일 (헤더, 메뉴) --- */
  .p-sidebar-header {
    padding: 0.75rem 1rem;
    border-bottom: 1px solid var(--surface-border);
    height: $header-height;
    display: flex;
    align-items: center;
  }
  .p-sidebar-content {
    padding: 0;
  }
}

/* 2. 콘텐츠 래퍼 (app-content-wrapper) */
.app-content-wrapper {
  padding-top: $header-height;
  min-height: 100vh;
  background-color: var(--surface-ground);

  display: flex;
  flex-direction: column;

  /* --- 데스크탑 (Push) --- */
  @media (min-width: 992px) {
    margin-left: $sidebar-width;
    transition: margin-left $transition-speed;
  }
  /* --- 모바일 (Full width) --- */
  @media (max-width: 991px) {
    margin-left: 0;
  }
}

/* 3. 헤더 (app-header) */
.app-header {
  position: fixed;
  top: 0;
  right: 0;
  z-index: 1000;
  height: $header-height;

  /* --- 데스크탑 (Push) --- */
  @media (min-width: 992px) {
    left: $sidebar-width;
    transition: left $transition-speed;
  }
  /* --- 모바일 (Full width) --- */
  @media (max-width: 991px) {
    left: 0;
  }

  .p-toolbar {
    height: 100%;
    .p-toolbar-group-start,
    .p-toolbar-group-end,
    .p-toolbar-content {
      display: flex;
      align-items: center;
      height: 100%;
    }
  }
}

/* 4. 메인 콘텐츠 (app-main-content) */
.app-main-content {
  padding: 1.5rem;

  flex-grow: 1;
  display: flex;
  flex-direction: column;

  width: 100%;
  margin-left: auto; /* 좌우 오토 마진으로 중앙 정렬 */
  margin-right: auto;

  /* 큰 화면(PC)에서만 너비를 제한하여 'col-9' 느낌을 줍니다.
     수치(1400px)는 원하시는 넓이에 맞춰 조절하시면 됩니다.
     (예: 1200px, 1400px, 1600px 또는 75% 등)
  */
  @media (min-width: 992px) {
    max-width: 95%; /* 일반 노트북 화면 */
  }

  @media (min-width: 1600px) {
    //max-width: 1400px; /* 대형 모니터에서 너무 넓어지지 않도록 고정 */
    max-width: 70%; /* 만약 비율로 유지하고 싶다면 이 주석을 해제하고 위 줄을 주석 처리하세요 */
  }
}

/* 5. 사이드바 숨김 상태 (데스크탑 전용) */
.sidebar-hidden {
  @media (min-width: 992px) {
    .app-sidebar.p-sidebar {
      /* * "닫힘" 상태: 이 선택자(.sidebar-hidden .app-sidebar)는
       * 위의 "열림" 상태(.app-sidebar)보다 더 구체적이므로
       * "열림" 상태의 transform: ... !important; 를 덮어쓰고 정상 작동합니다.
      */
      transform: translateX(-100%) !important;
    }
    .app-content-wrapper {
      margin-left: 0;
    }
    .app-header {
      left: 0;
    }
  }
}

/* 6. 로고 토글 (데스크탑 전용) */
@media (min-width: 992px) {
  .app-sidebar {
    .sidebar-brand-narrow {
      display: none;
    }
    .sidebar-brand-full {
      display: inline-block;
    }
  }
  .sidebar-hidden {
    .app-sidebar {
      .sidebar-brand-narrow {
        display: inline-block;
      }
      .sidebar-brand-full {
        display: none;
      }
    }
  }
}
/* 모바일에선 항상 전체 로고 */
@media (max-width: 991px) {
  .app-sidebar {
    .sidebar-brand-narrow {
      display: none !important;
    }
    .sidebar-brand-full {
      display: inline-block !important;
    }
  }
}

/* 7. Breadcrumb 스타일 */
.app-breadcrumb {
  border: none !important;
  background: none !important;
  padding: 1rem 1.5rem 1rem 1.5rem;
  .p-breadcrumb {
    padding: 0;
  }
}

.p-column-filter {
  width: 100%;
  .p-inputtext,
  .p-dropdown {
    width: 100%;
  }
}

.p-password {
  display: inline-block;
}
